/*! d4 - v0.1.0
 *  License: MIT Expat
 *  Date: 2014-02-24
 */
/*!
  Functions "each", "extend", and "isFunction" based on Underscore.js 1.5.2
  http://underscorejs.org
  (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
  Underscore may be freely distributed under the MIT license.
*/
(function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=this,e={},n=function(t){return t instanceof n?t:this instanceof n?(this.d4Wrapped=t,void 0):new n(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports.d4=n):t.d4=n,n.features={},n.parsers={};var r=n.each=n.forEach=function(t,n,r){var i,s,a=Array.prototype.forEach;if(null!==t)if(a&&t.forEach===a)t.forEach(n,r);else if(t.length===+t.length){for(i=0,s=t.length;s>i;i++)if(n.call(r,t[i],i,t)===e)return}else{var u=d3.keys(t);for(i=0,s=u.length;s>i;i++)if(n.call(r,t[u[i]],u[i],t)===e)return}},i=function(t){return!!(t&&t.constructor&&t.call&&t.apply)},s=function(t){return!i(t)},a=function(t){throw Error("[d4] "+t)},u=function(t){return r(["configure"],function(e){(!t[e]||s(t[e]))&&a("The supplied builder does not have a "+e+" function")}),t},c=function(t){return this.builder||(this.builder=u(t.bind(this)())),this},o=function(t,e){e||a("No builder defined");var r=n.merge({width:400,height:400,features:{},mixins:[],xKey:"x",yKey:"y",valueKey:"y",margin:{top:20,right:20,bottom:20,left:40}},t);return c.bind(r)(e),r.accessors=["margin","width","height","x","y","xKey","yKey","valueKey"].concat(t.accessors||[]),r},h=function(t,e){e&&r(d3.keys(t._proxiedFunctions),function(n){r(t._proxiedFunctions[n],function(t){e[n].apply(e,t)})})},d=function(t,e){t.mixins.forEach(function(n){var r=t.features[n].render.bind(t)(t.features[n],e);h(t.features[n],r)})},f=function(t,e){t.builder?(t.builder.configure(t,e),d(t,e)):a("No builder defined")},l=function(t,e){this.svg=d3.select(t).selectAll("svg").data([e]),this.featuresGroup=this.svg.enter().append("svg").append("g").attr("class","featuresGroup").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.svg.attr("width",this.width).attr("height",this.height).attr("class","d4"),this.svg.append("defs")},y=function(t){return function(e){e.each(function(e){l.bind(t,this)(e),f(t,e)})}},x=function(t){return t.overrides?t.overrides(this):{}},p=function(t,e,n){n!==void 0?(n=Math.max(Math.min(n,t.length),0),t.splice(n,0,e)):t.push(e)},g=function(t){t._proxiedFunctions={on:[]},t.on=function(){t._proxiedFunctions.on.push(Array.prototype.slice.call(arguments))}},b=function(t){g(t);var e=t.accessors;e&&r(d3.keys(e),function(e){t[e]=function(n){return arguments.length?(t.accessors[e]=n,t):t.accessors[e]}.bind(this)})},v=function(t,e){t||a("You need to supply an object to mixin.");var r=d3.keys(t)[0],i=x.bind(this)(t,r);t[r]=n.merge(t[r](r),i),n.extend(this.features,t),p(this.mixins,r,e),b(this.features[r])},m=function(t){t||a("A name is required in order to mixout a chart feature."),delete this.features[t],this.mixins=this.mixins.filter(function(e){return e!==t})},K=function(t,e){var n=this.features[t];s(e)&&a("You must supply a continuation function in order to use a chart feature."),n?e.bind(this)(n):a('Could not find feature: "'+t+'", maybe you forgot to mix it in?')};n.baseChart=function(t,e){var n=o(t,e),r=y(n);/*!
      FIXME: d4 wraps the inner property object `opts` in a series of class
    functions. For example: `chart.width(300)` will set the internal
    `opts.width` property to 300. Additionally chart.width() will return 300.
    However, this behavior creates ambiguity in API because it is unclear to the
    developer which accessors require functions and which can simply supply
    values. Ideally the API should support something like this:
    chart.xKey('foo') or chart.xKey(function(){ return 'foo'; })
    Presently only the latter is allowed, which is confusing.
    */
return r.accessors=n.accessors,r.accessors.forEach(function(t){r[t]=function(e){return arguments.length?(n[t]=e,r):n[t]}}),r.using=function(t,e){return K.bind(n)(t,e),r},r.mixin=function(t,e){return v.bind(n)(t,e),r},r.mixout=function(t,e){return m.bind(n)(t,e),r},r.builder=function(t){return u(t.bind(r)(n)),r},r.features=function(){return n.mixins},r},n.functor=function(t){return i(t)?t:function(){return t}},n.merge=function(t,e){return n.extend(n.extend({},t),e)},n.extend=function(t){return r(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var r in e)e[r]&&e[r].constructor&&e[r].constructor===Object?(t[r]=t[r]||{},n.extend(t[r],e[r])):t[r]=e[r]}),t}}).call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){var t=function(t,e){t.x||(t.xRoundBands=t.xRoundBands||.3,t.x=d3.scale.ordinal().domain(e.map(function(t){return t[this.xKey]}.bind(t))).rangeRoundBands([0,t.width-t.margin.left-t.margin.right],t.xRoundBands))},e=function(t,e){t.y||(t.y=d3.scale.linear().domain(d3.extent(e,function(t){return t[this.yKey]}.bind(t)))),t.y.range([t.height-t.margin.top-t.margin.bottom,0]).clamp(!0).nice()},n=function(n,r){t.bind(this)(n,r),e.bind(this)(n,r)},r={configure:function(t,e){n.bind(this)(t,e)}};return r};d4.columnChart=function(){var e=d4.baseChart({},t);return[{bars:d4.features.columnSeries},{barLabels:d4.features.columnLabels},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){e.mixin(t)}),e}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){var t=function(t,e){var n=t.map(function(t){return t.values.map(function(t){return t[e]}.bind(this))}.bind(this));return d3.merge(n)},e=function(e,n){if(!e.x){var r=t(n,e.xKey);e.xRoundBands=e.xRoundBands||.3,e.x=d3.scale.ordinal().domain(r).rangeRoundBands([0,e.width-e.margin.left-e.margin.right],e.xRoundBands)}},n=function(e,n){if(!e.y){var r=t(n,e.yKey),i=d3.extent(r);e.y=d3.scale.linear().domain([Math.min(0,i[0]),i[1]])}e.y.range([e.height-e.margin.top-e.margin.bottom,0]).clamp(!0).nice()},r=function(t,r){e.bind(this)(t,r),n.bind(this)(t,r)},i={configure:function(t,e){r.bind(this)(t,e)}};return i};d4.groupedColumnChart=function(){var e=d4.baseChart({accessors:["groupsOf"],groupsOf:1},t);return[{bars:d4.features.groupedColumnSeries},{columnLabels:d4.features.groupedColumnLabels},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){e.mixin(t)}),e}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){var t=function(t,e){var n=t.map(function(t){return t.values.map(function(t){return t[e]}.bind(this))}.bind(this));return d3.merge(n)},e=function(e,n){if(!e.x){var r=t(n,e.xKey);e.xRoundBands=e.xRoundBands||.3,e.x=d3.scale.ordinal().domain(r).rangeRoundBands([0,e.width-e.margin.left-e.margin.right],e.xRoundBands)}},n=function(e,n){if(!e.y){var r=t(n,e.yKey),i=d3.extent(r);e.y=d3.scale.linear().domain(i)}e.y.range([e.height-e.margin.top-e.margin.bottom,0]).clamp(!0).nice()},r=function(t,r){e.bind(this)(t,r),n.bind(this)(t,r)},i={configure:function(t,e){r.bind(this)(t,e)}};return i};d4.lineChart=function(){var e=d4.baseChart({},t);return[{linesSeries:d4.features.lineSeries},{linesSeriesLabels:d4.features.lineSeriesLabels},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){e.mixin(t)}),e}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){var t=function(t,e){t.x||(t.x=d3.scale.linear().domain(d3.extent(e,function(e){return e[t.xKey]}.bind(this)))),t.x.range([0,t.width-t.margin.right-t.margin.left]).clamp(!0).nice()},e=function(t,e){t.y||(t.yRoundBands=t.yRoundBands||.3,t.y=d3.scale.ordinal().domain(e.map(function(e){return e[t.yKey]}.bind(this))).rangeRoundBands([t.height-t.margin.top-t.margin.bottom,0],t.yRoundBands))},n=function(n,r){t.bind(this)(n,r),e.bind(this)(n,r)},r={configure:function(t,e){n.bind(this)(t,e)}};return r};d4.rowChart=function(){var e=d4.baseChart({margin:{top:20,right:40,bottom:20,left:40}},t);return[{bars:d4.features.rowSeries},{rowLabels:d4.features.rowLabels},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){e.mixin(t)}),e}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){var t=function(t,e){if(!t.x){var n=d3.extent(e,function(e){return e[t.xKey]}.bind(this));t.x=d3.scale.linear().domain(n).nice().clamp(!0)}t.x.range([0,t.width-t.margin.left-t.margin.right])},e=function(t,e){if(!t.y){var n=d3.extent(e,function(e){return e[t.yKey]}.bind(this));t.y=d3.scale.linear().domain(n).nice().clamp(!0)}t.y.range([t.height-t.margin.top-t.margin.bottom,0])},n=function(t,e){if(!t.z){var n=d3.extent(e,function(e){return e[t.zKey]}.bind(this));t.z=d3.scale.linear().domain(n).nice().clamp(!0)}var r=t.height-t.margin.top-t.margin.bottom;t.z.range([r/e.length,r/(5*e.length)])},r=function(r,i){t.bind(this)(r,i),e.bind(this)(r,i),n.bind(this)(r,i)},i={configure:function(t,e){r.bind(this)(t,e)}};return i};d4.scatterPlot=function(){var e=d4.baseChart({accessors:["z","zKey"],zKey:"z"},t);return[{circles:d4.features.scatterSeries},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){e.mixin(t)}),e}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){var t=function(t,e){var n=t.map(function(t){return t.values.map(function(t){return t[e]}.bind(this))}.bind(this));return d3.merge(n)},e=function(e,n){if(!e.x){var r=t(n,e.xKey);e.xRoundBands=e.xRoundBands||.3,e.x=d3.scale.ordinal().domain(r).rangeRoundBands([0,e.width-e.margin.left-e.margin.right],e.xRoundBands)}},n=function(t,e){if(!t.y){var n=d3.extent(d3.merge(e.map(function(t){return d3.extent(t.values,function(t){return t.y+t.y0})})));t.y=d3.scale.linear().domain([Math.min(0,n[0]),n[1]])}t.y.range([t.height-t.margin.top-t.margin.bottom,0]).clamp(!0).nice()},r=function(t,r){e.bind(this)(t,r),n.bind(this)(t,r)},i={configure:function(t,e){r.bind(this)(t,e)}};return i};d4.stackedColumnChart=function(){var e=d4.baseChart({},t);return[{bars:d4.features.stackedColumnSeries},{columnLabels:d4.features.stackedColumnLabels},{connectors:d4.features.stackedColumnConnectors},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){e.mixin(t)}),e}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";var t=function(){return"vertical"},e=function(){return{accessors:{y:function(t){if("vertical"===this.orientation()){var e=t.y0+t.y-Math.min(0,t.y);return this.y(e)}return this.y(t[this.yKey])},x:function(t){if("vertical"===this.orientation())return this.x(t[this.xKey]);var e=t.y0+t.y-Math.max(0,t.y);return this.x(e)},width:function(t){return"vertical"===this.orientation()?this.x.rangeBand():Math.abs(this.x(t.y0)-this.x(t.y0+t.y))},height:function(t){return"vertical"===this.orientation()?Math.abs(this.y(t.y0)-this.y(t.y0+t.y)):this.y.rangeBand()},classes:function(t,e,n){var r=t.y>0?"positive":"negative";return n>0&&0===t.y0&&(r="subtotal"),"bar fill item"+e+" "+r+" "+t[this.yKey]}}}},n=function(){return{accessors:{y:function(t){if("vertical"===this.orientation()){var e=Math.abs(this.y(t.y0)-this.y(t.y0+t.y)),n=t.y0+t.y-Math.max(0,t.y);return this.y(n)-10-e}return this.y(t[this.yKey])+this.y.rangeBand()/2},x:function(t){if("vertical"===this.orientation())return this.x(t[this.xKey])+this.x.rangeBand()/2;var e=t.y0+t.y-Math.max(0,t.y),n=Math.abs(this.x(t.y0)-this.x(t.y0+t.y));return this.x(e)+10+n},text:function(t){return d3.format("").call(this,t[this.valueKey])}}}},r=function(){var t=function(t,e){var n;return"x"===e?[0,t.width-t.margin.left-t.margin.right]:(n=[0,t.height-t.margin.top-t.margin.bottom],"vertical"===t.orientation().toLowerCase()?n.reverse():n)},e=function(e,n,r){if(!e[n]){var i=r.map(function(t){return t.key}.bind(this));e[n]=d3.scale.ordinal().domain(i).rangeRoundBands(t.bind(this)(e,n),e.xRoundBands||.3)}},n=function(e,n,r){if(!e[n]){var i=d3.extent(d3.merge(r.map(function(t){return d3.extent(t.values,function(t){return t.y+t.y0})})));i[0]=Math.min(0,i[0]),e[n]=d3.scale.linear().domain(i)}e[n].range(t.bind(this)(e,n)).clamp(!0).nice()},r=function(t,r){"vertical"===t.orientation().toLowerCase()?(e.bind(this)(t,"x",r),n.bind(this)(t,"y",r)):(e.bind(this)(t,"y",r),n.bind(this)(t,"x",r))},i={configure:function(t,e){r.bind(this)(t,e)}};return i};d4.waterfallChart=function(){var i=d4.baseChart({accessors:["orientation"],orientation:t},r);return[{bars:d4.features.stackedColumnSeries,overrides:e},{connectors:d4.features.waterfallConnectors},{columnLabels:d4.features.stackedColumnLabels,overrides:n},{xAxis:d4.features.xAxis},{yAxis:d4.features.yAxis}].forEach(function(t){i.mixin(t)}),i}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.arrow=function(t){return{accessors:{tipSize:function(){return 6},x1:function(){return this.x(0)},x2:function(){return this.x(this.width-this.margin.left-this.margin.right)},y1:function(){return this.y(0)},y2:function(){return this.y(this.height-this.margin.top-this.margin.bottom)}},render:function(e){var n=this.svg.select("defs");n.append("marker").attr("id",t+"-end").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",e.accessors.tipSize.bind(this)).attr("markerHeight",e.accessors.tipSize.bind(this)).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z"),n.append("marker").attr("id",t+"-start").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",-e.accessors.tipSize.bind(this)()).attr("markerHeight",e.accessors.tipSize.bind(this)).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z"),this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).append("line").attr("class","line").attr("x1",e.accessors.x1.bind(this)).attr("x2",e.accessors.x2.bind(this)).attr("y1",e.accessors.y1.bind(this)).attr("y2",e.accessors.y2.bind(this)).attr("marker-end","url(#"+t+"-end)");return r}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.columnLabels=function(t){return{accessors:{x:function(t){return this.x(t[this.xKey])+this.x.rangeBand()/2},y:function(t){var e=Math.abs(this.y(t[this.yKey])-this.y(0));return(0>t[this.yKey]?this.y(t[this.yKey])-e:this.y(t[this.yKey]))-5},text:function(t){return d3.format("").call(this,t[this.yKey])}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t).data(n);return r.enter().append("text"),r.exit().remove(),r.attr("class","column-label").text(e.accessors.text.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)),r}}}}.call(this),/*!

  DEPRECATION WARNING: This feature is deprecated in favor of using the nested
  column series renderer. Intrinsicly this makes sense because a normal column
  chart is mearly a stacked column chart with only one series.
*/
function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.columnSeries=function(t){return{accessors:{x:function(t){return this.x(t[this.xKey])},y:function(t){return 0>t[this.yKey]?this.y(0):this.y(t[this.yKey])},width:function(){return this.x.rangeBand()},height:function(t){return Math.abs(this.y(t[this.yKey])-this.y(0))},classes:function(t,e){return 0>t[this.yKey]?"bar negative fill series"+e:"bar positive fill series"+e}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t+"Series").data(n);r.enter().append("g"),r.exit().remove(),r.attr("class",function(t,e){return"series"+e});var i=r.selectAll("rect").data(function(t){return[t]});return i.enter().append("rect"),i.exit().remove(),i.attr("class",e.accessors.classes.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)).attr("width",e.accessors.width.bind(this)).attr("height",e.accessors.height.bind(this)),i}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.grid=function(t){return{accessors:{formatXAxis:function(t){return t.orient("bottom")},formatYAxis:function(t){return t.orient("left")}},render:function(e){var n=d3.svg.axis().scale(this.x),r=d3.svg.axis().scale(this.y),i=e.accessors.formatXAxis.bind(this)(n),s=e.accessors.formatYAxis.bind(this)(r);this.featuresGroup.append("g").attr("class","grid border "+t).attr("transform","translate(0,0)").append("rect").attr("x",0).attr("y",0).attr("width",this.width-this.margin.left-this.margin.right).attr("height",this.height-this.margin.top-this.margin.bottom),this.featuresGroup.append("g").attr("class","x grid "+t).attr("transform","translate(0,"+(this.height-this.margin.top-this.margin.bottom)+")").call(i.tickSize(-(this.height-this.margin.top-this.margin.bottom),0,0).tickFormat("")),this.featuresGroup.append("g").attr("class","y grid "+t).attr("transform","translate(0,0)").call(s.tickSize(-(this.width-this.margin.left-this.margin.right),0,0).tickFormat(""))}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.groupedColumnLabels=function(t){return{accessors:{x:function(t,e){var n=this.x.rangeBand()/this.groupsOf,r=this.x(t[this.xKey])+n*e,i=.1*n;return r+n/2-i},y:function(t){return(0>t[this.yKey]?this.y(0):this.y(t[this.yKey]))-5},text:function(t){return d3.format("").call(this,t[this.yKey])}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll(".group").data(n).enter().append("g").attr("class",function(t,e){return"series"+e+" "+this.xKey}.bind(this)),i=r.selectAll("text").data(function(t){return t.values}.bind(this));return i.exit().remove(),i.enter().append("text").attr("class","column-label").text(e.accessors.text.bind(this)).attr("y",e.accessors.y.bind(this)).attr("x",e.accessors.x.bind(this)),i}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.groupedColumnSeries=function(t){var e=function(t){return t>0?"positive":"negative"};return{accessors:{x:function(t,e){var n=this.x.rangeBand()/this.groupsOf,r=this.x(t[this.xKey])+n*e;return r},y:function(t){return 0>t[this.yKey]?this.y(0):this.y(t[this.yKey])},width:function(){var t=this.x.rangeBand()/this.groupsOf,e=.1*t;return t-e},height:function(t){return Math.abs(this.y(t[this.yKey])-this.y(0))},classes:function(t,n){return"bar fill item"+n+" "+e(t[this.yKey])+" "+t[this.yKey]}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll(".group").data(n);r.enter().append("g"),r.exit().remove(),r.attr("class",function(t,e){return"series"+e+" "+this.xKey}.bind(this));var i=r.selectAll("rect").data(function(t){return t.values}.bind(this));return i.enter().append("rect").attr("class",e.accessors.classes.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)).attr("width",e.accessors.width.bind(this)).attr("height",e.accessors.height.bind(this)),i}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.lineSeriesLabels=function(t){return{accessors:{x:function(t){return this.x(t.values[t.values.length-1][this.xKey])},y:function(t){return this.y(t.values[t.values.length-1][this.yKey])},text:function(t){return t.key},classes:function(t,e){return"stroke series"+e}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t).data(n);return r.enter().append("text"),r.exit().remove(),r.attr("class","lineSeriesLabel").text(e.accessors.text.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)).attr("data-key",function(t){return t.key}).attr("class",e.accessors.classes.bind(this)),r}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.lineSeries=function(t){return{accessors:{x:function(t){return this.x(t[this.xKey])},y:function(t){return this.y(t[this.yKey])},interpolate:function(){return"basis"},classes:function(t,e){return"line stroke series"+e}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=d3.svg.line().interpolate(e.accessors.interpolate.bind(this)()).x(e.accessors.x.bind(this)).y(e.accessors.y.bind(this)),i=this.svg.select("."+t).selectAll(".group").data(n);i.exit().remove(),i.enter().append("g").attr("data-key",function(t){return t.key}).attr("class",function(t,e){return"series"+e}.bind(this)).append("path").attr("d",function(t){return r(t.values)})}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.referenceLine=function(t){return{accessors:{x1:function(){return this.x(0)},x2:function(){return this.x(this.width-this.margin.left-this.margin.right)},y1:function(){return this.y(0)},y2:function(){return this.y(this.height)}},render:function(e){this.featuresGroup.append("g").attr("class",t);var n=this.svg.select("."+t).append("line").attr("class","line").attr("x1",e.accessors.x1.bind(this)).attr("x2",e.accessors.x2.bind(this)).attr("y1",e.accessors.y1.bind(this)).attr("y2",e.accessors.y2.bind(this));return n}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.rowLabels=function(t){return{accessors:{x:function(t){return this.x(Math.min(0,t[this.xKey]))+Math.abs(this.x(t[this.xKey])-this.x(0))+20},y:function(t){return this.y(t[this.yKey])+this.y.rangeBand()/2},text:function(t){return d3.format("").call(this,t[this.xKey])}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t).data(n);return r.enter().append("text"),r.exit().remove(),r.attr("class","column-label").text(e.accessors.text.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)),r}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.rowSeries=function(t){return{accessors:{x:function(t){return this.x(Math.min(0,t[this.xKey]))},y:function(t){return this.y(t[this.yKey])},height:function(){return this.y.rangeBand()},width:function(t){return Math.abs(this.x(t[this.xKey])-this.x(0))},classes:function(t,e){return 0>t[this.xKey]?"bar negative fill series"+e:"bar positive fill series"+e}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t).data(n);return r.enter().append("rect"),r.exit().remove(),r.attr("class",e.accessors.classes.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)).attr("width",e.accessors.width.bind(this)).attr("height",e.accessors.height.bind(this)),r}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.scatterSeries=function(t){return{accessors:{cx:function(t){return this.x(t[this.xKey])},cy:function(t){return this.y(t[this.yKey])},r:function(t){return this.z(t[this.zKey])},classes:function(t,e){return"dot series"+e+" fill"}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t).data(n);return r.enter().append("circle"),r.attr("class",e.accessors.classes.bind(this)).attr("r",e.accessors.r.bind(this)).attr("cx",e.accessors.cx.bind(this)).attr("cy",e.accessors.cy.bind(this)),r}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
/*!
    Column connectors helpful when displaying a stacked column chart.
    A connector will not connect positve and negative columns. This is because
    in a stacked column a negative column may move many series below its previous
    location. This creates a messy collection of crisscrossing lines.
  */
"use strict";d4.features.stackedColumnConnectors=function(t){return{accessors:{x1:function(t){var e=0,n=t.y0+t.y-Math.max(0,t.y);return t.y>0&&(e=Math.abs(this.x(t.y0)-this.x(t.y0+t.y))),this.x(n)+e},y1:function(t){return this.y(t[this.yKey])},span:function(){return this.y.rangeBand()},classes:function(t,e){return"series"+e}},render:function(e){this.featuresGroup.append("g").attr("class",t);var n=this.svg.select("."+t).selectAll("."+t).data(function(t){return t.map(function(t){return t.values[0]})}.bind(this));return n.enter().append("line"),n.exit().remove(),n.attr("class",e.accessors.classes.bind(this)).attr("x1",function(){}.bind(this)).attr("y1",function(){}.bind(this)).attr("x2",function(){}.bind(this)).attr("y2",function(){}.bind(this)),n}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.stackedColumnLabels=function(t){var e=function(t){return t>0?"positive":"negative"};return{accessors:{x:function(t){return this.x(t[this.xKey])+this.x.rangeBand()/2},y:function(t){var e=Math.abs(this.y(t.y0)-this.y(t.y0+t.y))/2,n=t.y0+t.y;return(0>n?this.y(t.y0):this.y(n))+e},text:function(t){return Math.abs(this.y(t.y0)-this.y(t.y0+t.y))>20?d3.format("").call(this,t[this.valueKey]):void 0}},render:function(n,r){this.featuresGroup.append("g").attr("class",t);var i=this.svg.select("."+t).selectAll(".group").data(r).enter().append("g").attr("class",function(t,n){return"series"+n+" "+e(t.y)+" "+this.xKey}.bind(this)),s=i.selectAll("text").data(function(t){return t.values}.bind(this));return s.exit().remove(),s.enter().append("text").text(n.accessors.text.bind(this)).attr("class","column-label").attr("y",n.accessors.y.bind(this)).attr("x",n.accessors.x.bind(this)),s}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.stackedColumnSeries=function(t){var e=function(t){return t>0?"positive":"negative"};return{accessors:{x:function(t){return this.x(t[this.xKey])},y:function(t){var e=t.y0+t.y;return 0>e?this.y(t.y0):this.y(e)},width:function(){return this.x.rangeBand()},height:function(t){return Math.abs(this.y(t.y0)-this.y(t.y0+t.y))},classes:function(t,n){return"bar fill item"+n+" "+e(t.y)+" "+t[this.yKey]}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll(".group").data(n).enter().append("g").attr("class",function(t,e){return"series"+e+" "+this.yKey}.bind(this)),i=r.selectAll("rect").data(function(t){return t.values}.bind(this));return i.enter().append("rect").attr("class",e.accessors.classes.bind(this)).attr("x",e.accessors.x.bind(this)).attr("y",e.accessors.y.bind(this)).attr("width",e.accessors.width.bind(this)).attr("height",e.accessors.height.bind(this)),i}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.trendLine=function(t){return{accessors:{x1:function(){return this.x(0)},x2:function(){return this.x(this.width)},y1:function(){return this.y(0)},y2:function(){return this.y(this.height)},text:function(t){return d3.format("").call(this,t[1])},textX:function(){return this.x(this.width)},textY:function(){return this.x(this.height)}},render:function(e){var n=this.svg.select("defs");n.append("marker").attr("id",t+"-start").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",-6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z"),this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).append("line").attr("class","line").attr("x1",e.accessors.x1.bind(this)).attr("x2",e.accessors.x2.bind(this)).attr("y1",e.accessors.y1.bind(this)).attr("y2",e.accessors.y2.bind(this)).attr("marker-end","url(#"+t+"-start)");return this.svg.select("."+t).append("text").attr("class","trendLine-label").text(e.accessors.text.bind(this)).attr("x",e.accessors.textX.bind(this)).attr("y",e.accessors.textY.bind(this)),r}}}}.call(this),function(){"use strict";/*!
   * global d3: false
   * global d4: false
   */
d4.features.waterfallConnectors=function(t){return{accessors:{x:function(t){if("horizontal"===this.orientation()){var e=0,n=t.y0+t.y-Math.max(0,t.y);return t.y>0&&(e=Math.abs(this.x(t.y0)-this.x(t.y0+t.y))),this.x(n)+e}return this.x(t[this.xKey])},y:function(t){return"horizontal"===this.orientation()?this.y(t[this.yKey]):this.y(t.y0+t.y)},span:function(){return"horizontal"===this.orientation()?this.y.rangeBand():this.x.rangeBand()},classes:function(t,e){return"series"+e}},render:function(e,n){this.featuresGroup.append("g").attr("class",t);var r=this.svg.select("."+t).selectAll("."+t).data(function(t){return t.map(function(t){return t.values[0]})}.bind(this));return r.enter().append("line"),r.exit().remove(),r.attr("class",e.accessors.classes.bind(this)).attr("x1",function(t,r){return 0===r?0:e.accessors.x.bind(this)(n[r-1].values[0])}.bind(this)).attr("y1",function(t,r){return 0===r?0:e.accessors.y.bind(this)(n[r-1].values[0])}.bind(this)).attr("x2",function(t,r){return 0===r?0:"vertical"===this.orientation()?e.accessors.x.bind(this)(t)+e.accessors.span.bind(this)():e.accessors.x.bind(this)(n[r-1].values[0])}.bind(this)).attr("y2",function(t,r){return 0===r?0:"vertical"===this.orientation()?e.accessors.y.bind(this)(n[r-1].values[0]):e.accessors.y.bind(this)(t)+e.accessors.span.bind(this)(t)}.bind(this)),r}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.xAxis=function(t){return{accessors:{format:function(t){return t.orient("bottom").tickSize(0)}},render:function(e){var n=d3.svg.axis().scale(this.x),r=e.accessors.format.bind(this)(n);this.featuresGroup.append("g").attr("class","x axis "+t).attr("transform","translate(0,"+(this.height-this.margin.top-this.margin.bottom)+")").call(r)}}}}.call(this),function(){/*!
   * global d3: false
   * global d4: false
   */
"use strict";d4.features.yAxis=function(t){var e=function(t,e){t.each(function(){var t,n=d3.select(this),r=n.text().split(/\s+/).reverse(),i=[],s=0,a=1.1,u=n.attr("x"),c=n.attr("y"),o=parseFloat(n.attr("dy")),h=n.text(null).append("tspan").attr("x",u).attr("y",c).attr("dy",o+"em");for(t=r.pop();t;)i.push(t),h.text(i.join(" ")),h.node().getComputedTextLength()>e-Math.abs(u)&&(i.pop(),h.text(i.join(" ")),i=[t],h=n.append("tspan").attr("x",u).attr("y",c).attr("dy",++s*a+o+"em").text(t)),t=r.pop()})};return{accessors:{format:function(t){return t.orient("left").tickSize(0)}},render:function(n){var r=d3.svg.axis().scale(this.y),i=n.accessors.format.bind(this)(r);this.featuresGroup.append("g").attr("class","y axis "+t).attr("transform","translate(0,0)").call(i).selectAll(".tick text").call(e,this.margin.left)}}}}.call(this),function(){/*! global d3: false */
/*! global d4: false */
"use strict";d4.parsers.nestedGroup=function(){var t={x:{key:"x",values:[]},y:{key:"y",values:[]},value:{key:"value",values:[]},data:[]};t.nestKey=function(){return t.x.key};var e=function(e,n){["x","y","value"].forEach(function(r){var i=n.map(function(t){return t[e[r].key]});t[r].values=d3.set(i).values()})},n=function(t,e,n){var r=d3.nest().key(function(e){return e[t]});return r.entries(n)},r=function(e,n){t[e].key=d4.functor(n)()},i=function(r){return r&&d4.extend(t.data,r),e(t,t.data),t.data=n(t.nestKey(),t.value.key,t.data),t};return i.nestKey=function(e){return t.nestKey=e.bind(t),i},i.x=function(e){return r.bind(t)("x",e),i},i.y=function(e){return r.bind(t)("y",e),i},i.value=function(e){return r.bind(t)("value",e),i},i}}.call(this),function(){/*! global d3: false */
/*! global d4: false */
"use strict";d4.parsers.nestedStack=function(){var t={x:{key:"x",values:[]},y:{key:"y",values:[]},value:{key:"value",values:[]},data:[]},e=function(e,n){["x","y","value"].forEach(function(r){var i=n.map(function(t){return t[e[r].key]});t[r].values=d3.set(i).values()})},n=function(t,e,n){var r=d3.nest().key(function(e){return e[t]});return r.entries(n)},r=function(e,n){var r={},i=d3.layout.stack().values(function(t){return t.values}).x(function(t){return t[e]}).y(function(e){return+e[t.value.key]}).out(function(t,n,i){t.y=i,t.y>=0?(t.y0=r[t[e]+"Pos"]=r[t[e]+"Pos"]||0,r[t[e]+"Pos"]+=i):(t.y0=r[t[e]+"Neg"]=r[t[e]+"Neg"]||0,r[t[e]+"Neg"]-=Math.abs(i))});i(n.reverse())},i=function(e,n){t[e].key=d4.functor(n)()},s=function(i){return i&&d4.extend(t.data,i),e(t,t.data),t.data=n(t.y.key,t.value.key,t.data),r(t.x.key,t.data),t};return s.x=function(e){return i.bind(t)("x",e),s},s.y=function(e){return i.bind(t)("y",e),s},s.value=function(e){return i.bind(t)("value",e),s},s}}.call(this),function(){/*! global d3: false */
/*! global d4: false */
"use strict";d4.parsers.waterfall=function(){var t={x:{key:"x",values:[]},y:{key:"y",values:[]},value:{key:"value",values:[]},data:[]};t.nestKey=function(){return t.x.key};var e=function(e,n){["x","y","value"].forEach(function(r){var i=n.map(function(t){return t[e[r].key]});t[r].values=d3.set(i).values()})},n=function(t,e,n){var r=d3.nest().key(function(e){return e[t]});return r.entries(n)},r=function(e,n){var r=0,i=function(t){return isNaN(t)?0:t},s=d3.layout.stack().values(function(t){return t.values}).x(function(t){return t[e]}).y(function(e){return+e[t.value.key]}).out(function(e,n,s){isNaN(s)?(isNaN(n)&&(n=r),e.y0=0,e.y=n,e[t.value.key]=n,r=n):(isNaN(n)?(e.y0=r,r+=s):e.y0=n,e.y=s,e[t.value.key]=i(e[t.value.key]))});s(n)},i=function(e,n){t[e].key=d4.functor(n)()},s=function(i){return i&&d4.extend(t.data,i),e(t,t.data),t.data=n(t.nestKey(),t.value.key,t.data),r(t.x.key,t.data),t};return s.nestKey=function(e){return t.nestKey=e.bind(t),s},s.x=function(e){return i.bind(t)("x",e),s},s.y=function(e){return i.bind(t)("y",e),s},s.value=function(e){return i.bind(t)("value",e),s},s}}.call(this);